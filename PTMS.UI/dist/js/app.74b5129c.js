(function(t){function e(e){for(var n,o,r=e[0],l=e[1],c=e[2],d=0,u=[];d<r.length;d++)o=r[d],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&u.push(i[o][0]),i[o]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);p&&p(e);while(u.length)u.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var t,e=0;e<s.length;e++){for(var a=s[e],n=!0,o=1;o<a.length;o++){var l=a[o];0!==i[l]&&(n=!1)}n&&(s.splice(e--,1),t=r(r.s=a[0]))}return t}var n={},i={app:0},s=[];function o(t){return r.p+"js/"+({}[t]||t)+"."+{"chunk-2d0a3577":"15b80f4c","chunk-2d0a43df":"2e00c125","chunk-2d0aab07":"ec9eaa41","chunk-2d0abc00":"1e61764e","chunk-2d0ae937":"22b2ec66","chunk-2d0aeb45":"c571eeac","chunk-2d0afa49":"65108fc0","chunk-2d0b2762":"7faa5aa3","chunk-2d0b6187":"1b01ea3f","chunk-2d0ba136":"08ad9b83","chunk-2d0bb267":"7da55a18","chunk-2d0bcec1":"eed4b121","chunk-2d0bff92":"5eac84e3","chunk-2d0c0494":"b82491b3","chunk-2d0c0a09":"ab666bda","chunk-2d0c1ed0":"c7612dd8","chunk-2d0c4313":"734ea760","chunk-2d0c46d1":"a90d3520","chunk-2d0c512b":"c2655e61","chunk-2d0cf16e":"c3e2c753","chunk-2d0d056d":"34332182","chunk-2d0d0645":"5ba0a827","chunk-2d0d2f22":"0b0ad9f9","chunk-2d0d7e63":"967be54e","chunk-2d0e1b57":"9ca83b35","chunk-2d0e1fbe":"085b36f1","chunk-2d0e22d6":"f15418dd","chunk-2d0e542a":"f9c1a461","chunk-2d0e57ec":"db5e2796","chunk-2d0e6553":"e43be0ff","chunk-2d0ea098":"59254529","chunk-2d208ac5":"b30c459d","chunk-2d209408":"f92607b1","chunk-2d20f745":"2c8189f8","chunk-2d20ff23":"57e1f9e1","chunk-2d2138c7":"4a97aa4a","chunk-2d217e5b":"40de0dd2","chunk-2d21b84a":"4bfe2261","chunk-2d21dcd2":"64e0a422","chunk-2d21f327":"4df1e469","chunk-2d2214b3":"4f3fe061","chunk-2d221a34":"7ff16b79","chunk-2d22502a":"f9b13f63","chunk-2d228ca6":"741b4c1c","chunk-2d2295e9":"599758ba","chunk-2d22c171":"55accc8a","chunk-2d22c2b8":"fef13e00","chunk-2d22ca58":"fe58906c","chunk-2d2311f7":"3c951f38","chunk-2d237ee7":"3cd1af21","chunk-2d238465":"3860df71","chunk-7532b3ea":"d6aa1a5e","chunk-774ac664":"7e1ba16f"}[t]+".js"}function r(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.e=function(t){var e=[],a=i[t];if(0!==a)if(a)e.push(a[2]);else{var n=new Promise(function(e,n){a=i[t]=[e,n]});e.push(a[2]=n);var s,l=document.createElement("script");l.charset="utf-8",l.timeout=120,r.nc&&l.setAttribute("nonce",r.nc),l.src=o(t);var c=new Error;s=function(e){l.onerror=l.onload=null,clearTimeout(d);var a=i[t];if(0!==a){if(a){var n=e&&("load"===e.type?"missing":e.type),s=e&&e.target&&e.target.src;c.message="Loading chunk "+t+" failed.\n("+n+": "+s+")",c.name="ChunkLoadError",c.type=n,c.request=s,a[1](c)}i[t]=void 0}};var d=setTimeout(function(){s({type:"timeout",target:l})},12e4);l.onerror=l.onload=s,document.head.appendChild(l)}return Promise.all(e)},r.m=t,r.c=n,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(a,n,function(e){return t[e]}.bind(null,n));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/",r.oe=function(t){throw console.error(t),t};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],c=l.push.bind(l);l.push=e,l=l.slice();for(var d=0;d<l.length;d++)e(l[d]);var p=c;s.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";a("c21b")},1:function(t,e){},"15a5":function(t,e,a){"use strict";a("7f10")},"409e":function(t,e,a){"use strict";a("4db3")},"4c85":function(t,e,a){"use strict";a("56f5")},"4db3":function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);var n=a("2b0e"),i=a("8a03"),s=a.n(i),o=a("f2d9"),r=a("28dd"),l=a("00e7"),c=a.n(l),d=(a("5abe"),a("41e6"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"full-screen",attrs:{id:"app"}},[a("router-view")],1)}),p=[],u=(a("034f"),a("2877")),m={},f=Object(u["a"])(m,d,p,!1,null,null,null),b=f.exports,h=a("8c4f"),g=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"home"},[a("b-loading",{attrs:{"is-full-page":!0,active:t.isLoading,"can-cancel":!1},on:{"update:active":function(e){t.isLoading=e}}}),a("NavBar"),a("div",{staticClass:"container template-list"},[a("b-field",[a("b-input",{staticStyle:{width:"100%"},attrs:{placeholder:"search by name, description or id...",type:"search",icon:"magnify"},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.search(e):null}},model:{value:t.query,callback:function(e){t.query=e},expression:"query"}}),a("p",{staticClass:"control"},[a("button",{staticClass:"button is-primary",on:{click:t.search}},[t._v("Search")])])],1)],1),a("TemplateList",{attrs:{onDelete:t.onDelete,templates:t.templates,onSelectedVersion:t.changeSelectedVersion}})],1)},v=[],y=(a("c5f6"),a("7f7f"),{api:"https://ptms.01.test.api.lb.ge/api"}),_=a("71f1"),w=a.n(_),k=a("aeb1"),C=a.n(k),x=a("0828"),T={handleUnauthorized:function(t,e){t.status===x["UNAUTHORIZED"]&&e.$router.push({name:"login"})},handleLargePayload:function(t,e){t.status===x["REQUEST_TOO_LONG"]&&e.$toast.open({duration:5e3,message:"Request is too large, max size of requiest is 6mb",position:"is-top",type:"is-danger",queue:!1})},handleInternal:function(t,e){if([x["INTERNAL_SERVER_ERROR"],x["NOT_FOUND"],0].indexOf(t.status)>=0){var a=36e5;e.$toast.open({duration:a,message:"Something happened to the server :(",position:"is-top",type:"is-danger",queue:!1}),e.$snackbar.open({duration:a,message:"Something happened, please try to reload page",type:"is-danger",position:"is-bottom-right",actionText:"Reload",queue:!1,onAction:function(){return e.$router.go()}})}},isBad:function(t){return t.status===x["BAD_REQUEST"]},destroyTemplate:function(t,e,a,n){a.$dialog.confirm({title:"Deleting template",message:"Are you sure you want to <b>delete</b> template: ".concat(t,", ").concat(e),confirmText:"Delete",type:"is-danger",hasIcon:!0,onConfirm:function(){a.isLoading=!0,a.$http.delete("".concat(y.api,"/templates/").concat(t)).then(function(){a.isLoading=!1,a.$toast.open({message:"Template deleted!",position:"is-top",type:"is-success"}),n&&n(t)},function(t){T.handleUnauthorized(t,a),T.handleInternal(t,a),T.isBad(t)&&a.$toast.open({message:"Cant delete template",position:"is-top",type:"is-warning"}),a.isLoading=!1})}})},destroyTemplateBulk:function(t,e,a){t.length?e.$dialog.confirm({title:"Deleting templates",message:"Are you sure you want to <b>delete</b> ".concat(t.length," templates"),confirmText:"Delete",type:"is-danger",hasIcon:!0,onConfirm:function(){e.isLoading=!0,w.a.each(t,function(t,a){e.$http.delete("".concat(y.api,"/templates/").concat(t._id)).then(a,function(t){T.handleUnauthorized(t,e),T.handleInternal(t,e),T.isBad(t)&&e.$toast.open({message:"Bad request",position:"is-top",type:"is-warning"})})},function(){e.isLoading=!1,e.$toast.open({message:"Templates deleted!",position:"is-top",type:"is-success"}),a&&a(t[0])})}}):e.$toast.open({message:"Select templates first!",position:"is-top",type:"is-warning"})},destroyPartial:function(t,e,a,n){a.$dialog.confirm({title:"Deleting partial",message:"Are you sure you want to <b>delete</b> partial: ".concat(t,", ").concat(e),confirmText:"Delete",type:"is-danger",hasIcon:!0,onConfirm:function(){a.isLoading=!0,a.$http.delete("".concat(y.api,"/partials/").concat(t)).then(function(){a.isLoading=!1,a.$toast.open({message:"Partial deleted!",position:"is-top",type:"is-success"}),n&&n(t)},function(t){T.handleUnauthorized(t,a),T.handleInternal(t,a),T.isBad(t)&&a.$toast.open({message:"Cant delete partial",position:"is-top",type:"is-warning"}),a.isLoading=!1})}})},destroyPartialBulk:function(t,e,a){t.length?e.$dialog.confirm({title:"Deleting partials",message:"Are you sure you want to <b>delete</b> ".concat(t.length," partials"),confirmText:"Delete",type:"is-danger",hasIcon:!0,onConfirm:function(){e.isLoading=!0,w.a.each(t,function(t,a){e.$http.delete("".concat(y.api,"/partials/").concat(t._id)).then(a,function(t){T.handleUnauthorized(t,e),T.handleInternal(t,e),T.isBad(t)&&e.$toast.open({message:"Bad request",position:"is-top",type:"is-warning"})})},function(){e.isLoading=!1,e.$toast.open({message:"Partials deleted!",position:"is-top",type:"is-success"}),a&&a(t[0])})}}):e.$toast.open({message:"Select partials first!",position:"is-top",type:"is-warning"})},previewTemplatePdf:function(t,e,a){a.isLoading=!0,a.$http.post("".concat(y.api,"/templates/").concat(t,"/render/pdf/").concat(e),{caching:!1},{responseType:"arraybuffer"}).then(function(e){var n="application/pdf",i=new Blob([e.data],{type:n});C()(i,"preview-".concat(t,".pdf"),n),a.isLoading=!1},function(t){T.handleUnauthorized(t,a),T.handleInternal(t,a),T.isBad(t)&&(a.$toast.open({message:"Cant preview template pdf",position:"is-top",type:"is-warning"}),a.isLoading=!1)})},previewTemplateTxt:function(t,e,a){a.$http.post("".concat(y.api,"/templates/").concat(t,"/render/txt/").concat(e)).then(function(t){a.$modal.open('<iframe style="width: 100%; height: 100vh;" src="data:text/html;base64,'.concat(btoa(unescape(encodeURIComponent(t.bodyText))),'"></iframe>'))},function(t){T.handleUnauthorized(t,a),T.handleInternal(t,a),T.isBad(t)&&a.$toast.open({message:"Cant preview template html",position:"is-top",type:"is-warning"})})},onlyUnique:function(t,e,a){return a.indexOf(t)===e}},L=T,S=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container-fluid",staticStyle:{"margin-bottom":"20px"}},[a("nav",{staticClass:"navbar",staticStyle:{background:"#000","box-shadow":"0 1px 10px rgba(0,0,0,.3)"},attrs:{role:"navigation","aria-label":"main navigation"}},[a("div",{staticClass:"container"},[t._m(0),a("div",{staticClass:"navbar-menu"},[a("div",{staticClass:"navbar-end"},[a("router-link",{staticClass:"navbar-item",attrs:{to:"/"}},[a("b-icon",{attrs:{icon:"file-document",size:"is-small"}}),a("span",[t._v("Templates")])],1),a("router-link",{staticClass:"navbar-item",attrs:{to:"/partials"}},[a("b-icon",{attrs:{icon:"file-multiple",size:"is-small"}}),a("span",[t._v("Global Partials")])],1)],1)])])])])},E=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"navbar-brand"},[a("a",{staticClass:"navbar-item",attrs:{href:"/"}},[a("img",{attrs:{src:"https://proway.ge/img/logo-header.svg"}})]),a("a",{staticClass:"navbar-burger burger",attrs:{role:"button","aria-label":"menu","aria-expanded":"false","data-target":"navbarBasicExample"}},[a("span",{attrs:{"aria-hidden":"true"}}),a("span",{attrs:{"aria-hidden":"true"}}),a("span",{attrs:{"aria-hidden":"true"}})])])}],$=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card"},[a("div",{staticClass:"card-content"},[a("div",{staticClass:"media"},[t._m(0),a("div",{staticClass:"media-content"},[a("p",{staticClass:"title is-4"},[t._v("Sandro "),a("b-icon",{attrs:{icon:"gitlab"}}),a("a",{staticStyle:{margin:"0 5px 0 5px"},attrs:{target:"_blank",href:"https://gitlab.com/svireli/sandro-front"}},[t._v("front-end")]),a("a",{staticStyle:{margin:"0 5px 0 5px"},attrs:{target:"_blank",href:"https://gitlab.com/svireli/sandro"}},[t._v("back-end")])],1),t._m(1)])]),t._m(2)])])},I=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"media-left"},[a("figure",{staticClass:"image is-48x48"},[a("img",{attrs:{src:"/sandro.png",alt:"Placeholder image"}})])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",{staticClass:"subtitle is-6"},[t._v("By "),a("a",{attrs:{href:"https://gitlab.com/svireli"}},[t._v("Goga Lominashvili")]),t._v(" (g.lominashvili@gmail.com)")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content"},[t._v('\n      Sandro is a very performant and resource friendly template management system,\n      it uses full chromium engine,\n      memory cached precompiled moustache html templates and couchdb\n      to render templates blazing fast.\n      It also supports many optimization options for input based file caching,\n      external resource load optimization and\n      header/footer templates.\n      Sandro is released under original 4-clause "BSD license",\n      contributors are more than welcome.\n      '),a("pre",{staticClass:"small"},[t._v("          Copyright (c) 2018, Goga Lominashvili\n          All rights reserved.\n\n          Redistribution and use in source and binary forms, with or without\n          modification, are permitted provided that the following conditions are met:\n          1. Redistributions of source code must retain the above copyright\n             notice, this list of conditions and the following disclaimer.\n          2. Redistributions in binary form must reproduce the above copyright\n             notice, this list of conditions and the following disclaimer in the\n             documentation and/or other materials provided with the distribution.\n          3. All advertising materials mentioning features or use of this software\n             must display the following acknowledgement:\n             This product includes software developed by Goga Lominashvili.\n          4. Neither the name of Goga Lominashvili nor the\n             names of its contributors may be used to endorse or promote products\n             derived from this software without specific prior written permission.\n\n          THIS SOFTWARE IS PROVIDED BY GOGA LOMINASHVILI ''AS IS'' AND ANY\n          EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n          WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n          DISCLAIMED. IN NO EVENT SHALL GOGA LOMINASHVILI BE LIABLE FOR ANY\n          DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n          (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n          LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n          ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n          (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n          SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n      ")])])}],D={name:"InfoForm"},O=D,R=(a("409e"),Object(u["a"])(O,$,I,!1,null,"18ec3816",null)),A=R.exports,P={name:"NavBar",methods:{onInfo:function(){var t=this;this.$modal.open({parent:t,component:A,hasModalCard:!0})}}},N=P,U=(a("e434"),Object(u["a"])(N,S,E,!1,null,"76793dee",null)),B=U.exports,z=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container template-list"},[a("b-loading",{attrs:{"is-full-page":!0,active:t.isLoading,"can-cancel":!1},on:{"update:active":function(e){t.isLoading=e}}}),a("button",{staticClass:"button field is-primary",on:{click:t.addNew}},[a("b-icon",{attrs:{icon:"plus"}}),a("span",[t._v("New Template")])],1),a("button",{staticClass:"button field is-success",on:{click:t.backup}},[a("b-icon",{attrs:{icon:"archive"}}),a("span",[t._v("Backup")])],1),a("b-upload",{on:{input:t.restore},model:{value:t.restoreFile,callback:function(e){t.restoreFile=e},expression:"restoreFile"}},[a("a",{staticClass:"button field is-success"},[a("b-icon",{attrs:{icon:"upload"}}),a("span",[t._v("Restore")])],1)]),a("button",{staticClass:"button field is-danger",on:{click:t.onBulkDestroy}},[a("b-icon",{attrs:{icon:"trash-can"}}),a("span",[t._v("Delete Selected")])],1),a("download-excel",{staticClass:"button field is-success",attrs:{fetch:t.fetchData,"before-generate":t.startDownload,"before-finish":t.finishDownload,type:"xls"}},[a("b-icon",{attrs:{icon:"export"}}),a("span",[t._v("Export")])],1),t._l(t.categories,function(e){return a("b-collapse",{key:e,staticClass:"card",staticStyle:{margin:"5px 0px 5px 0px"},attrs:{data:e,open:!1},scopedSlots:t._u([{key:"trigger",fn:function(n){return a("div",{staticClass:"card-header"},[a("p",{staticClass:"card-header-title"},[t._v(t._s(e)+" ("+t._s(t.catTemplates[e].length)+")")]),a("a",{staticClass:"card-header-icon"},[a("b-icon",{attrs:{icon:n.open?"menu-down":"menu-up"}})],1)])}}])},[a("div",{staticClass:"card-content"},[a("div",{staticClass:"content"},[a("b-table",{ref:"table",refInFor:!0,staticClass:"m-t-10",attrs:{"default-sort-direction":"desc","default-sort":"updated",data:t.catTemplates[e],"checked-rows":t.checkedRows[e],narrowed:!1,hoverable:!0,detailed:"","detail-key":"_id",checkable:""},on:{"update:checkedRows":function(a){t.$set(t.checkedRows,e,a)}},scopedSlots:t._u([{key:"default",fn:function(e){return[a("b-table-column",{attrs:{width:"300",label:"ID",centered:""}},[a("strong",[t._v(t._s(e.row._id))])]),a("b-table-column",{attrs:{label:"Name",field:"name",sortable:"",centered:""}},[t._v(t._s(e.row.name))]),a("b-table-column",{attrs:{label:"Last Updated",field:"updated",sortable:"",centered:""}},[t._v(t._s(new Date(e.row.updated).toLocaleString("en-US")))]),a("b-table-column",{attrs:{label:"Version",field:"version",sortable:"",centered:""}},[a("select",{on:{change:function(a){t.handleversionchange(a,e.row._id)}}},t._l(e.row.versions,function(e){return a("option",[t._v(t._s(e))])}))]),a("b-table-column",{attrs:{label:"Editor",field:"name",sortable:"",centered:""}},[t._v(t._s(e.row.editor))]),a("b-table-column",{attrs:{label:"Action",centered:""}},[a("b-tooltip",{staticClass:"is-success",attrs:{label:"Edit template"}},[a("button",{staticClass:"button is-small is-success",on:{click:function(a){t.edit(e.row._id)}}},[a("b-icon",{attrs:{icon:"pencil",size:"is-small"}})],1)]),a("b-tooltip",{staticClass:"is-primary",attrs:{label:"Preview template HTML"}},[a("button",{staticClass:"button is-small is-primary",on:{click:function(a){t.onTxtPreview(e.row._id,e.row.version)}}},[a("b-icon",{attrs:{icon:"eye",size:"is-small"}})],1)]),a("b-tooltip",{staticClass:"is-primary",attrs:{label:"Preview template PDF"}},[a("button",{staticClass:"button is-small is-primary",on:{click:function(a){t.onPdfPreview(e.row._id,e.row.version)}}},[a("b-icon",{attrs:{icon:"file",size:"is-small"}})],1)]),a("b-tooltip",{staticClass:"is-danger",attrs:{label:"Delete template"}},[a("button",{staticClass:"button is-small is-danger",on:{click:function(a){t.onDestroy(e.row._id,e.row.name)}}},[a("b-icon",{attrs:{icon:"delete-forever",size:"is-small"}})],1)])],1)]}},{key:"detail",fn:function(e){return[a("article",{staticClass:"media"},[a("div",{staticClass:"media-content"},[a("div",{staticClass:"content"},[a("p",[a("strong",[t._v("Description:")])]),a("p",[t._v(t._s(e.row.description))])])])])]}}])},[a("template",{slot:"empty"},[a("section",{staticClass:"section"},[a("div",{staticClass:"content has-text-grey has-text-centered"},[a("p",[a("b-icon",{attrs:{icon:"emoticon-sad",size:"is-large"}})],1),a("p",[t._v("No Templates")])])])])],2)],1)])])})],2)},F=[],j=(a("456d"),a("96cf"),a("1da1")),V=(a("ac6a"),a("6b54"),{backupTemplates:function(t){var e=[],a=Object.keys(t.checkedRows).reduce(function(e,a){return e.concat(t.checkedRows[a])},[]);a.length?(t.isLoading=!0,w.a.each(a,function(a,n){t.$http.get("".concat(y.api,"/templates/").concat(a._id,"/").concat(a.selectedVersion)).then(function(t){e.push(t.body.data),n()},function(e){L.handleUnauthorized(e,t),L.handleInternal(e,t),L.isBad(e)&&t.$toast.open({message:"Bad request",position:"is-top",type:"is-warning"})})},function(){t.isLoading=!1,C()(new Blob([JSON.stringify(e)]),"templates-backup-".concat(Date.now(),".json"),"application/json")}),t.isLoading=!1):t.$toast.open({message:"Select templates first!",position:"is-top",type:"is-warning"})},backupPartials:function(t){var e=[],a=Object.keys(t.checkedRows).reduce(function(e,a){return e.concat(t.checkedRows[a])},[]);a.length?(t.isLoading=!0,w.a.each(a,function(a,n){t.$http.get("".concat(y.api,"/partials/").concat(a._id)).then(function(t){e.push(t.body.data),n()},function(e){L.handleUnauthorized(e,t),L.handleInternal(e,t),L.isBad(e)&&t.$toast.open({message:"Bad request",position:"is-top",type:"is-warning"})})},function(){t.isLoading=!1,C()(new Blob([JSON.stringify(e)]),"partials-backup-".concat(Date.now(),".json"),"application/json")}),t.isLoading=!1):t.$toast.open({message:"Select partials first!",position:"is-top",type:"is-warning"})},restoreTemplates:function(t,e){var a=new FileReader;a.onloadend=function(){var t=JSON.parse(a.result.toString("utf-8"));w.a.each(t,function(t,a){t.restore=!0,e.$http.put("".concat(y.api,"/templates"),t).then(function(){a()},function(t){L.handleUnauthorized(t,e),L.handleInternal(t,e),e.isLoading=!1,L.isBad(t)&&e.$toast.open({message:"Bad request",position:"is-top",type:"is-warning"})})},function(){e.$router.go()})},a.readAsText(t)},restorePartials:function(t,e){var a=new FileReader;a.onloadend=function(){var t=JSON.parse(a.result);w.a.each(t,function(t,a){t.restore=!0,e.$http.put("".concat(y.api,"/partials"),t).then(function(){a()},function(t){L.handleUnauthorized(t,e),L.handleInternal(t,e),e.isLoading=!1,L.isBad(t)&&e.$toast.open({message:"Bad request",position:"is-top",type:"is-warning"})})},function(){e.$router.go()})},a.readAsText(t)}}),H=V,q=a("bc3a"),M=a.n(q),G={name:"TemplateList",props:{templates:Array,onDelete:Function,onSelectedVersion:Function},data:function(){return{isLoading:!1,restoreFile:null,checkedRows:{}}},computed:{categories:function(){var t=this.templates.map(function(t){return t.category}).filter(L.onlyUnique).filter(function(t){return!!t&&t.trim()});return-1==t.indexOf("Uncategorized")&&t.push("Uncategorized"),t},catTemplates:function(){var t=this,e={};return this.categories.forEach(function(a){e[a]=t.templates.filter(function(t){return t.category===a})}),e["Uncategorized"]=e["Uncategorized"].concat(this.templates.filter(function(t){return!t.category||!t.category.trim()})),e}},methods:{fetchData:function(){var t=Object(j["a"])(regeneratorRuntime.mark(function t(){var e,a,n,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=this,t.next=3,M.a.get("".concat(y.api,"/export"));case 3:return a=t.sent,n=Object.keys(e.checkedRows).reduce(function(t,a){return t.concat(e.checkedRows[a])},[]),i=0==n.length?a.data.data:[],0==i.length&&a.data.data.forEach(function(t){1==n.filter(function(e){return e._id==t._id}).length&&i.push({id:t._id,name:t.name,description:t.description,category:t.category,created:new Date(t.created),updated:new Date(t.updated),creator:t.creator,editor:t.editor,templateTxt:t.templateTxt})}),t.abrupt("return",i);case 9:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),startDownload:function(){},finishDownload:function(){},addNew:function(){this.$router.push({name:"template-new"})},onPdfPreview:function(t,e){L.previewTemplatePdf(t,e,this)},onTxtPreview:function(t,e){L.previewTemplateTxt(t,e,this)},onDestroy:function(t,e){var a=this;L.destroyTemplate(t,e,a,a.onDelete)},onBulkDestroy:function(){var t=this,e=Object.keys(t.checkedRows).reduce(function(e,a){return e.concat(t.checkedRows[a])},[]);L.destroyTemplateBulk(e,t,t.onDelete)},edit:function(t){var e=this;e.$router.push({name:"template-edit",params:{id:t}})},backup:function(){H.backupTemplates(this)},restore:function(t){H.restoreTemplates(t,this)},handleversionchange:function(t,e){var a=this;a.onSelectedVersion(e,t.target.value)}}},Y=G,W=(a("c31e"),Object(u["a"])(Y,z,F,!1,null,"c1a47142",null)),J=W.exports,Q={name:"home",components:{NavBar:B,TemplateList:J},data:function(){return{isLoading:!0,templates:[],query:""}},mounted:function(){this.loadTemplates()},methods:{changeSelectedVersion:function(t,e){var a=this,n=a.templates;n=n.map(function(a){return a._id==t&&(a.selectedVersion=e),a}),a.templates=n},search:function(){var t=this;t.$http.get("".concat(y.api,"/templates")).then(function(e){t.isLoading=!1,t.templates=e.body.data.filter(function(e){return e.name.indexOf(t.query)>-1||e.description.indexOf(t.query)>-1||e._id==t.query}),t.templates=t.templates.map(function(t){var e=null==t.version?1:Number(t.version.substr(1));t.versions=[];for(var a=e;a>0;a--)t.versions.push("v".concat(a));return t.selectedVersion=t.version,t})},function(e){L.handleUnauthorized(e,t),L.handleInternal(e,t),t.isLoading=!1})},onDelete:function(){this.loadTemplates()},loadTemplates:function(){var t=this;t.$http.get("".concat(y.api,"/templates")).then(function(e){t.isLoading=!1;var a=e.body.data;a=a.map(function(t){var e=null==t.version?1:Number(t.version.substr(1));t.versions=[];for(var a=e;a>0;a--)t.versions.push("v".concat(a));return t.selectedVersion=t.version,t}),t.templates=a},function(e){L.handleUnauthorized(e,t),L.handleInternal(e,t),t.isLoading=!1})}}},K=Q,X=Object(u["a"])(K,g,v,!1,null,null,null),Z=X.exports,tt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("b-loading",{attrs:{"is-full-page":!0,active:t.isLoading,"can-cancel":!1},on:{"update:active":function(e){t.isLoading=e}}}),a("NavBar"),a("div",{staticClass:"container"},[a("div",{staticClass:"columns"},[a("div",{staticClass:"column is-half"},[a("button",{staticClass:"button is-success",on:{click:t.onSave}},[a("b-icon",{attrs:{icon:"content-save"}}),a("span",[t._v("Save")])],1),a("button",{staticClass:"button is-primary",attrs:{disabled:!t.template._id},on:{click:t.onTxtPreview}},[a("b-icon",{attrs:{icon:"eye"}}),a("span",[t._v("Html")])],1),a("button",{staticClass:"button is-primary",attrs:{disabled:!t.template._id},on:{click:t.onPdfPreview}},[a("b-icon",{attrs:{icon:"file"}}),a("span",[t._v("PDF")])],1),a("button",{staticClass:"button is-danger",attrs:{disabled:!t.template._id},on:{click:t.onDestroy}},[a("b-icon",{attrs:{icon:"delete-forever"}}),a("span",[t._v("Remove")])],1),a("button",{staticClass:"button is-success",attrs:{disabled:!t.template._id},on:{click:t.onUpgrade}},[a("b-icon",{attrs:{icon:"arrow-up"}}),a("span",[t._v("Change Version")])],1)]),a("div",{staticClass:"column"},[a("b-field",{attrs:{grouped:""}},[a("b-field",{attrs:{"custom-class":"is-small",label:"Version",expanded:""}},[a("b-input",{attrs:{size:"is-small",type:"text",disabled:""},model:{value:t.template.version,callback:function(e){t.$set(t.template,"version",e)},expression:"template.version"}})],1),a("b-field",{attrs:{"custom-class":"is-small",label:"Name",expanded:""}},[a("b-input",{attrs:{size:"is-small",maxlength:"50",hascounter:""},model:{value:t.template.name,callback:function(e){t.$set(t.template,"name",e)},expression:"template.name"}})],1),a("b-field",{attrs:{"custom-class":"is-small",label:"Description",expanded:""}},[a("b-input",{attrs:{size:"is-small",maxlength:"1500",hascounter:""},model:{value:t.template.description,callback:function(e){t.$set(t.template,"description",e)},expression:"template.description"}})],1),a("b-field",{attrs:{"custom-class":"is-small",label:"Category"}},[a("b-autocomplete",{attrs:{data:t.filteredCategories,placeholder:"e.g. IBank, CRM",icon:"magnify",size:"is-small"},on:{select:function(e){return t.template.category=e}},model:{value:t.template.category,callback:function(e){t.$set(t.template,"category",e)},expression:"template.category"}},[a("template",{slot:"empty"},[t._v("No categories found")])],2)],1)],1)],1)])]),a("div",{staticClass:"container"},[a("b-tabs",{staticClass:"block",attrs:{position:"is-centered"},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[a("b-tab-item",{attrs:{icon:"pencil",label:"Editor"}},[a("div",{staticClass:"container",attrs:{id:"template-editor",tabindex:"0"},on:{keydown:function(e){return("button"in e||83===e.keyCode)&&e.ctrlKey?void t.onSave(e):null}}})]),a("b-tab-item",{attrs:{icon:"settings",label:"Settings"}},[a("div",{staticClass:"container"},[a("div",{staticClass:"columns"},[a("div",{staticClass:"column"},[a("b-field",{attrs:{"custom-class":"is-small",label:"ID"}},[a("b-tooltip",{attrs:{position:"is-right",label:"This is unique identified of this template used for rendering"}},[a("strong",[t._v(t._s(t.template._id))])])],1),a("b-field",{attrs:{"custom-class":"is-small",label:"Created"}},[a("b-tooltip",{attrs:{position:"is-right",label:"Template creation date"}},[a("strong",[t._v(t._s(new Date(t.template.created).toString()))])])],1),a("b-field",{attrs:{"custom-class":"is-small",label:"Creator"}},[a("b-tooltip",{attrs:{position:"is-right",label:"User who originally created this template"}},[a("strong",[t._v(t._s(t.template.creator))])])],1),a("b-field",{attrs:{"custom-class":"is-small",label:"Updated"}},[a("b-tooltip",{attrs:{position:"is-right",label:"Last modified date"}},[a("strong",[t._v(t._s(new Date(t.template.updated).toString()))])])],1),a("b-field",{attrs:{"custom-class":"is-small",label:"Editor"}},[a("b-tooltip",{attrs:{position:"is-right",label:"User who edited template"}},[a("strong",[t._v(t._s(t.template.editor))])])],1),a("b-field",{attrs:{"custom-class":"is-small",label:"Scale"}},[a("b-tooltip",{attrs:{position:"is-right",label:"Scale of the document, be carefoul, this must be double, positive"}},[a("b-input",{attrs:{size:"is-small"},model:{value:t.template.options.scale,callback:function(e){t.$set(t.template.options,"scale",e)},expression:"template.options.scale"}})],1)],1),a("b-field",[a("b-field",{attrs:{"custom-class":"is-small",label:"Top margin"}},[a("b-input",{attrs:{size:"is-small"},model:{value:t.template.options.margin.top,callback:function(e){t.$set(t.template.options.margin,"top",e)},expression:"template.options.margin.top"}})],1),a("b-field",{attrs:{"custom-class":"is-small",label:"Bottom margin"}},[a("b-input",{attrs:{size:"is-small"},model:{value:t.template.options.margin.bottom,callback:function(e){t.$set(t.template.options.margin,"bottom",e)},expression:"template.options.margin.bottom"}})],1)],1),a("b-field",[a("b-field",{attrs:{"custom-class":"is-small",label:"Right margin"}},[a("b-input",{attrs:{size:"is-small"},model:{value:t.template.options.margin.right,callback:function(e){t.$set(t.template.options.margin,"right",e)},expression:"template.options.margin.right"}})],1),a("b-field",{attrs:{"custom-class":"is-small",label:"Left margin"}},[a("b-input",{attrs:{size:"is-small"},model:{value:t.template.options.margin.left,callback:function(e){t.$set(t.template.options.margin,"left",e)},expression:"template.options.margin.left"}})],1)],1)],1),a("div",{staticClass:"column"},[a("b-field",{attrs:{"custom-class":"is-small",label:"External sources"}},[a("b-tooltip",{attrs:{position:"is-right",label:"Renderer will wait for resources to be loaded, slows speed"}},[a("b-switch",{model:{value:t.template.loadExternalSources,callback:function(e){t.$set(t.template,"loadExternalSources",e)},expression:"template.loadExternalSources"}},[t._v(t._s(t.template.loadExternalSources?"Enabled":"Disabled"))])],1)],1),a("b-field",{attrs:{"custom-class":"is-small",label:"Display header/footer"}},[a("b-tooltip",{attrs:{position:"is-right",label:"Use header/footer templates to display info top/bottom"}},[a("b-switch",{model:{value:t.template.options.displayHeaderFooter,callback:function(e){t.$set(t.template.options,"displayHeaderFooter",e)},expression:"template.options.displayHeaderFooter"}},[t._v(t._s(t.template.options.displayHeaderFooter?"Enabled":"Disabled"))])],1)],1),a("b-field",{attrs:{"custom-class":"is-small",label:"Header template"}},[a("b-tooltip",{attrs:{position:"is-right",label:"Use css classes date,title,url,pageNumber,totalPages to inject data"}},[a("b-input",{attrs:{size:"is-small",type:"textarea"},model:{value:t.template.options.headerTemplate,callback:function(e){t.$set(t.template.options,"headerTemplate",e)},expression:"template.options.headerTemplate"}})],1)],1),a("b-field",{attrs:{"custom-class":"is-small",label:"Footer template"}},[a("b-tooltip",{attrs:{position:"is-right",label:"Use css classes date,title,url,pageNumber,totalPages to inject data"}},[a("b-input",{attrs:{size:"is-small",type:"textarea"},model:{value:t.template.options.footerTemplate,callback:function(e){t.$set(t.template.options,"footerTemplate",e)},expression:"template.options.footerTemplate"}})],1)],1)],1),a("div",{staticClass:"column"},[a("b-field",{attrs:{"custom-class":"is-small",label:"Caching"}},[a("b-tooltip",{attrs:{position:"is-right",label:"File is cached for every different input"}},[a("b-switch",{model:{value:t.template.caching,callback:function(e){t.$set(t.template,"caching",e)},expression:"template.caching"}},[t._v(t._s(t.template.caching?"Enabled":"Disabled"))])],1)],1),a("b-field",{attrs:{"custom-class":"is-small",label:"Background images"}},[a("b-tooltip",{attrs:{position:"is-top",label:"Check this if you want background graphics enabled"}},[a("b-switch",{model:{value:t.template.options.printBackground,callback:function(e){t.$set(t.template.options,"printBackground",e)},expression:"template.options.printBackground"}},[t._v(t._s(t.template.options.printBackground?"Enabled":"Disabled"))])],1)],1),a("b-field",{attrs:{"custom-class":"is-small",label:"Orientation"}},[a("b-tooltip",{attrs:{position:"is-top",label:"Orientation of document"}},[a("b-switch",{model:{value:t.template.options.landscape,callback:function(e){t.$set(t.template.options,"landscape",e)},expression:"template.options.landscape"}},[t._v(t._s(t.template.options.landscape?"Landscape":"Portrait"))])],1)],1),a("b-field",{attrs:{"custom-class":"is-small",label:"Document size"}},[a("b-tooltip",{attrs:{position:"is-top",label:"Document size is various formats"}},[a("b-select",{model:{value:t.template.options.format,callback:function(e){t.$set(t.template.options,"format",e)},expression:"template.options.format"}},[a("option",{attrs:{value:"Letter"}},[t._v("Letter: 8.5in x 11in")]),a("option",{attrs:{value:"Legal"}},[t._v("Legal: 8.5in x 14in")]),a("option",{attrs:{value:"Tabloid"}},[t._v("Tabloid: 11in x 17in")]),a("option",{attrs:{value:"Ledger"}},[t._v("Ledger: 17in x 11in")]),a("option",{attrs:{value:"A0"}},[t._v("A0: 33.1in x 46.8in")]),a("option",{attrs:{value:"A1"}},[t._v("A1: 23.4in x 33.1in")]),a("option",{attrs:{value:"A2"}},[t._v("A2: 16.5in x 23.4in")]),a("option",{attrs:{value:"A3"}},[t._v("A3: 11.7in x 16.5in")]),a("option",{attrs:{value:"A4"}},[t._v("A4: 8.27in x 11.7in")]),a("option",{attrs:{value:"A5"}},[t._v("A5: 5.83in x 8.27in")]),a("option",{attrs:{value:"A6"}},[t._v("A6: 4.13in x 5.83in")])])],1)],1)],1)])])]),a("b-tab-item",{attrs:{icon:"history",label:"Version History"}},[a("div",{staticClass:"container"},[a("b-table",{ref:"table",staticClass:"m-t-10",attrs:{"default-sort-direction":"desc","default-sort":"updated",data:t.template.versionControl,narrowed:!1,hoverable:!0},scopedSlots:t._u([{key:"default",fn:function(e){return[a("b-table-column",{attrs:{label:"Version",field:"version",sortable:"",centered:""}},[t._v(t._s(e.row.version))]),a("b-table-column",{attrs:{label:"Created",field:"created",sortable:"",centered:""}},[t._v(t._s(new Date(e.row.created).toLocaleString("en-US")))]),a("b-table-column",{attrs:{label:"Creator",field:"creator",sortable:"",centered:""}},[t._v(t._s(e.row.creator))]),a("b-table-column",{attrs:{label:"Action",centered:""}},[a("b-tooltip",{staticClass:"is-primary",staticStyle:{"margin-right":"5px"},attrs:{label:"Preview template HTML"}},[a("button",{staticClass:"button is-small is-primary",on:{click:function(a){t.onTxtPreviewVersion(e.row.version)}}},[a("b-icon",{attrs:{icon:"eye",size:"is-small"}})],1)]),a("b-tooltip",{staticClass:"is-primary",attrs:{label:"Preview template PDF"}},[a("button",{staticClass:"button is-small is-primary",on:{click:function(a){t.onPdfPreviewVersion(e.row.version)}}},[a("b-icon",{attrs:{icon:"file",size:"is-small"}})],1)])],1)]}}])})],1)])],1)],1)],1)},et=[],at=a("8ea9"),nt={template:'<!DOCTYPE HTML>\n<html>\n  <head>\n    <meta charset="utf-8">\n    <title></title>\n  </head>\n  <body>\n    {{Field}}\n    {{#ObjectOrArray}}\n      <h1>{{Attribute}}</h1>\n    {{/ObjectOrArray}}\n    {{>Partial}}\n  </body>\n</html>',header:'<span style="font-size: 30px; width: 200px; height: 200px; background-color: black; color: white; margin: 20px;">Header</span>',footer:'<span style="font-size: 30px; width: 50px; height: 50px; background-color: red; color:black; margin: 20px;">Footer</span>'},it=nt;function st(){return{_id:null,name:"",description:"",caching:!1,loadExternalSources:!1,template:it.template,created:Date.now(),creator:"",updated:Date.now(),editor:"",category:"",options:{scale:1,displayHeaderFooter:!1,headerTemplate:it.header,footerTemplate:it.footer,printBackground:!1,landscape:!1,format:"Letter",margin:{top:"0px",bottom:"0px",right:"0px",left:"0px"}}}}var ot=st,rt=(a("3022"),{name:"template-editor",props:{id:String},components:{NavBar:B},data:function(){return{isLoading:!0,template:ot(),editor:null,activeTab:0,categories:[],errors:[]}},computed:{filteredCategories:function(){var t=this;return this.categories.filter(function(e){return e.toString().toLowerCase().indexOf(t.template.category.toLowerCase())>=0})}},destroyed:function(){this.editor.dispose()},mounted:function(){var t=this;t.$http.get("".concat(y.api,"/categories/templates")).then(function(e){t.categories=e.body.data},function(e){L.handleUnauthorized(e,t),L.handleInternal(e,t),L.isBad(e)&&t.$toast.open({message:"Cant get template categories",position:"is-top",type:"is-warning"}),t.$router.push({name:"templates"})}),t.id?t.$http.get("".concat(y.api,"/templates/").concat(t.id)).then(function(e){e.body.data.category=e.body.data.category||"",t.template=e.body.data,t.$nextTick(function(){t.setupEditor(),t.isLoading=!1})},function(e){L.handleUnauthorized(e,t),L.handleInternal(e,t),L.isBad(e)&&t.$toast.open({message:"Id doest exsists or cant get template",position:"is-top",type:"is-warning"}),t.isLoading=!1,t.$router.push({name:"templates"})}):t.$nextTick(function(){t.setupEditor(),t.template.version="v1",t.isLoading=!1})},methods:{setupEditor:function(){var t=this;t.editor||(t.editor=at["a"].create(document.getElementById("template-editor"),{value:"",language:"html",theme:"vs-dark",readOnly:!1})),t.editor.setValue(t.template.template)},onPdfPreview:function(){L.previewTemplatePdf(this.template._id,this.template.version,this)},onTxtPreview:function(){L.previewTemplateTxt(this.template._id,this.template.version,this)},onPdfPreviewVersion:function(t){L.previewTemplatePdf(this.template._id,t,this)},onTxtPreviewVersion:function(t){L.previewTemplateTxt(this.template._id,t,this)},onDestroy:function(){var t=this;L.destroyTemplate(this.template._id,this.template.name,this,function(){return t.$router.push({name:"templates"})})},onUpgrade:function(t){var e=this;e.template.template=e.editor.getValue(),e.template.options.scale=parseInt(e.template.options.scale,10),e.$dialog.confirm({title:"Version Change",message:"Are you sure you want to <b>change</b> template version?",confirmText:"Yes",type:"is-info",hasIcon:!0,onConfirm:function(){e.isLoading=!0,console.log(e.template.version,"ver");var a=e.template.version.substring(1);console.log(a,"old"),e.isLoading=!1,e.template.version="v"+(parseInt(a)+1),console.log(e.template.version,"ver"),e.onSave(t)}})},onSave:function(t){t&&t.preventDefault();var e=this;e.isLoading=!0,e.template.template=e.editor.getValue(),e.template.options.scale=parseInt(e.template.options.scale,10);var a=e.template._id?"post":"put",n="".concat(y.api,"/templates");e.template._id&&(n="".concat(n,"/").concat(e.template._id)),e.$http[a](n,e.template).then(function(t){e.isLoading=!1,e.$toast.open({message:"Successfully saved",position:"is-top",type:"is-success"}),e.template._id||(e.template=ot(),e.$router.push({name:"template-edit",params:{id:t.body.data.id}}),e.$router.go())},function(t){L.handleUnauthorized(t,e),L.handleInternal(t,e),L.handleLargePayload(t,e),L.isBad(t)&&("ALREADY_REGISTERED"==t.body.msg?e.$toast.open({message:"template with this name already exists!",position:"is-top",type:"is-warning"}):e.$toast.open({message:"Wrong parameters, cant save template",position:"is-top",type:"is-warning"})),e.isLoading=!1})}}}),lt=rt,ct=(a("15a5"),Object(u["a"])(lt,tt,et,!1,null,null,null)),dt=ct.exports,pt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("b-loading",{attrs:{"is-full-page":!0,active:t.isLoading,"can-cancel":!1},on:{"update:active":function(e){t.isLoading=e}}}),a("NavBar"),a("PartialList",{attrs:{onDelete:t.onDelete,partials:t.partials}})],1)},ut=[],mt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container partial-list"},[a("b-loading",{attrs:{"is-full-page":!0,active:t.isLoading,"can-cancel":!1},on:{"update:active":function(e){t.isLoading=e}}}),a("button",{staticClass:"button field is-primary",on:{click:t.addNew}},[a("b-icon",{attrs:{icon:"plus"}}),a("span",[t._v("New Partial")])],1),a("button",{staticClass:"button field is-success",on:{click:t.backup}},[a("b-icon",{attrs:{icon:"archive"}}),a("span",[t._v("Backup")])],1),a("b-upload",{on:{input:t.restore},model:{value:t.restoreFile,callback:function(e){t.restoreFile=e},expression:"restoreFile"}},[a("a",{staticClass:"button field is-success"},[a("b-icon",{attrs:{icon:"upload"}}),a("span",[t._v("Restore")])],1)]),a("button",{staticClass:"button field is-danger",on:{click:t.onBulkDestroy}},[a("b-icon",{attrs:{icon:"trash-can"}}),a("span",[t._v("Delete Selected")])],1),t._l(t.categories,function(e){return a("b-collapse",{key:e,staticClass:"card",staticStyle:{margin:"5px 0px 5px 0px"},attrs:{data:e,open:!1},scopedSlots:t._u([{key:"trigger",fn:function(n){return a("div",{staticClass:"card-header"},[a("p",{staticClass:"card-header-title"},[t._v("\n        "+t._s(e)+" ("+t._s(t.catPartials[e].length)+")\n      ")]),a("a",{staticClass:"card-header-icon"},[a("b-icon",{attrs:{icon:n.open?"menu-down":"menu-up"}})],1)])}}])},[a("div",{staticClass:"card-content"},[a("div",{staticClass:"content"},[a("b-table",{attrs:{"default-sort":"updated","default-sort-direction":"desc",data:t.catPartials[e],"checked-rows":t.checkedRows[e],checkable:""},on:{"update:checkedRows":function(a){t.$set(t.checkedRows,e,a)}},scopedSlots:t._u([{key:"default",fn:function(e){return[a("b-table-column",{attrs:{width:"300",label:"ID",centered:""}},[a("strong",[a("span",[t._v("{{>")]),t._v(t._s(e.row._id)),a("span",[t._v("}}")])])]),a("b-table-column",{attrs:{label:"Name",field:"name",sortable:"",centered:""}},[t._v("\n              "+t._s(e.row.name)+"\n            ")]),a("b-table-column",{attrs:{label:"Description",field:"description",sortable:"",centered:""}},[t._v("\n              "+t._s(e.row.description)+"\n            ")]),a("b-table-column",{attrs:{label:"Last Updated",field:"updated",sortable:"",centered:""}},[t._v("\n              "+t._s(new Date(e.row.updated).toLocaleString("en-US"))+"\n            ")]),a("b-table-column",{attrs:{label:"Editor",field:"editor",sortable:"",centered:""}},[t._v("\n              "+t._s(e.row.editor)+"\n            ")]),a("b-table-column",{attrs:{label:"Action",centered:""}},[a("b-tooltip",{staticClass:"is-success",attrs:{label:"Edit partial"}},[a("button",{staticClass:"button is-small is-success",on:{click:function(a){t.edit(e.row._id)}}},[a("b-icon",{attrs:{icon:"pencil",size:"is-small"}})],1)]),a("b-tooltip",{staticClass:"is-danger",attrs:{label:"Delete partial"}},[a("button",{staticClass:"button is-small is-danger",on:{click:function(a){t.onDestroy(e.row._id,e.row.name)}}},[a("b-icon",{attrs:{icon:"delete-forever",size:"is-small"}})],1)])],1)]}}])},[a("template",{slot:"empty"},[a("section",{staticClass:"section"},[a("div",{staticClass:"content has-text-grey has-text-centered"},[a("p",[a("b-icon",{attrs:{icon:"emoticon-sad",size:"is-large"}})],1),a("p",[t._v("No Partials")])])])])],2)],1)])])})],2)},ft=[],bt={name:"PartialList",props:{partials:Array,onDelete:Function},data:function(){return{isLoading:!1,restoreFile:null,checkedRows:{}}},computed:{categories:function(){var t=this.partials.map(function(t){return t.category}).filter(L.onlyUnique).filter(function(t){return!!t&&t.trim()});return-1==t.indexOf("Uncategorized")&&t.push("Uncategorized"),t},catPartials:function(){var t=this,e={};return this.categories.forEach(function(a){e[a]=t.partials.filter(function(t){return t.category===a})}),e["Uncategorized"]=e["Uncategorized"].concat(this.partials.filter(function(t){return!t.category||!t.category.trim()})),e}},methods:{addNew:function(){this.$router.push({name:"partial-new"})},onDestroy:function(t,e){var a=this;L.destroyPartial(t,e,a,a.onDelete)},onBulkDestroy:function(){var t=this,e=Object.keys(t.checkedRows).reduce(function(e,a){return e.concat(t.checkedRows[a])},[]);L.destroyPartialBulk(e,t,t.onDelete)},edit:function(t){var e=this;e.$router.push({name:"partial-edit",params:{id:t}})},backup:function(){H.backupPartials(this)},restore:function(t){H.restorePartials(t,this)}}},ht=bt,gt=(a("8262"),Object(u["a"])(ht,mt,ft,!1,null,"e59980c0",null)),vt=gt.exports,yt={name:"partials-list",components:{NavBar:B,PartialList:vt},data:function(){return{isLoading:!0,partials:[]}},mounted:function(){this.loadTemplates()},methods:{onDelete:function(){this.loadTemplates()},loadTemplates:function(){var t=this;t.$http.get("".concat(y.api,"/partials")).then(function(e){t.isLoading=!1,t.partials=e.body.data},function(e){L.handleUnauthorized(e,t),L.handleInternal(e,t),t.isLoading=!1})}}},_t=yt,wt=Object(u["a"])(_t,pt,ut,!1,null,null,null),kt=wt.exports,Ct=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("b-loading",{attrs:{"is-full-page":!0,active:t.isLoading,"can-cancel":!1},on:{"update:active":function(e){t.isLoading=e}}}),a("NavBar"),a("div",{staticClass:"container"},[a("div",{staticClass:"columns"},[a("div",{staticClass:"column is-half"},[a("button",{staticClass:"button is-success",on:{click:t.onSave}},[a("b-icon",{attrs:{icon:"content-save"}}),a("span",[t._v("Save")])],1),a("button",{staticClass:"button is-danger",attrs:{disabled:!t.partial._id},on:{click:t.onDestroy}},[a("b-icon",{attrs:{icon:"delete-forever"}}),a("span",[t._v("Remove")])],1)]),a("div",{staticClass:"column"},[a("b-field",{attrs:{grouped:""}},[a("b-field",{attrs:{"custom-class":"is-small",label:"Name",expanded:""}},[a("b-input",{attrs:{size:"is-small",maxlength:"50",hascounter:""},model:{value:t.partial.name,callback:function(e){t.$set(t.partial,"name",e)},expression:"partial.name"}})],1),a("b-field",{attrs:{"custom-class":"is-small",label:"Description",expanded:""}},[a("b-input",{attrs:{size:"is-small",maxlength:"50",hascounter:""},model:{value:t.partial.description,callback:function(e){t.$set(t.partial,"description",e)},expression:"partial.description"}})],1),a("b-field",{attrs:{"custom-class":"is-small",label:"Category"}},[a("b-autocomplete",{attrs:{data:t.filteredCategories,placeholder:"e.g. IBank, CRM",icon:"magnify",size:"is-small"},on:{select:function(e){return t.partial.category=e}},model:{value:t.partial.category,callback:function(e){t.$set(t.partial,"category",e)},expression:"partial.category"}},[a("template",{slot:"empty"},[t._v("No categories found")])],2)],1)],1)],1)])]),a("div",{staticClass:"container"},[a("b-tabs",{staticClass:"block",attrs:{position:"is-centered"},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[a("b-tab-item",{attrs:{icon:"pencil",label:"Editor"}},[a("div",{staticClass:"container",attrs:{id:"template-editor",tabindex:"0"},on:{keydown:function(e){return("button"in e||83===e.keyCode)&&e.ctrlKey?void t.onSave(e):null}}})]),a("b-tab-item",{attrs:{icon:"settings",label:"Settings"}},[a("div",{staticClass:"container"},[a("div",{staticClass:"columns"},[a("div",{staticClass:"column"},[a("b-field",{attrs:{"custom-class":"is-small",label:"ID"}},[a("b-tooltip",{attrs:{position:"is-right",label:"This is unique identified of this partial used for rendering"}},[a("strong",[a("span",[t._v("{{>")]),t._v(t._s(t.partial._id)),a("span",[t._v("}}")])])])],1),a("b-field",{attrs:{"custom-class":"is-small",label:"Created"}},[a("b-tooltip",{attrs:{position:"is-right",label:"Partial creation date"}},[a("strong",[t._v(t._s(new Date(t.partial.created).toLocaleString("en-US")))])])],1),a("b-field",{attrs:{"custom-class":"is-small",label:"Creator"}},[a("b-tooltip",{attrs:{position:"is-right",label:"User who originally created this partial"}},[a("strong",[t._v(t._s(t.partial.creator))])])],1),a("b-field",{attrs:{"custom-class":"is-small",label:"Updated"}},[a("b-tooltip",{attrs:{position:"is-right",label:"Last modified date"}},[a("strong",[t._v(t._s(new Date(t.partial.updated).toLocaleString("en-US")))])])],1),a("b-field",{attrs:{"custom-class":"is-small",label:"Editor"}},[a("b-tooltip",{attrs:{position:"is-right",label:"User who edited partial"}},[a("strong",[t._v(t._s(t.partial.editor))])])],1)],1)])])])],1)],1)],1)},xt=[];function Tt(){return{template:"",created:Date.now(),creator:"",updated:Date.now(),editor:"",category:""}}var Lt=Tt,St={name:"partial-editor",props:{id:String},components:{NavBar:B},data:function(){return{isLoading:!0,partial:Lt(),editor:null,activeTab:0,categories:[]}},computed:{filteredCategories:function(){var t=this;return this.categories.filter(function(e){return e.toString().toLowerCase().indexOf(t.partial.category.toLowerCase())>=0})}},destroyed:function(){this.editor.dispose()},mounted:function(){var t=this;t.$http.get("".concat(y.api,"/categories/partials")).then(function(e){t.categories=e.body.data},function(e){L.handleUnauthorized(e,t),L.handleInternal(e,t),L.isBad(e)&&t.$toast.open({message:"Cant get partial categories",position:"is-top",type:"is-warning"}),t.$router.push({name:"partials"})}),t.id?t.$http.get("".concat(y.api,"/partials/").concat(t.id)).then(function(e){e.body.data.category=e.body.data.category||"",t.partial=e.body.data,t.$nextTick(function(){t.setupEditor(),t.isLoading=!1})},function(e){L.handleUnauthorized(e,t),L.handleInternal(e,t),L.isBad(e)&&t.$toast.open({message:"Id doest exsists or cant get partial",position:"is-top",type:"is-warning"}),t.isLoading=!1,t.$router.push({name:"partials"})}):t.$nextTick(function(){t.setupEditor(),t.isLoading=!1})},methods:{setupEditor:function(){var t=this;t.editor||(t.editor=at["a"].create(document.getElementById("template-editor"),{value:"",language:"html",theme:"vs-dark",readOnly:!1})),t.editor.setValue(t.partial.template)},onDestroy:function(){var t=this;L.destroyPartial(this.partial._id,this.partial.name,this,function(){return t.$router.push({name:"partials"})})},onSave:function(t){t&&t.preventDefault();var e=this;e.isLoading=!0,e.partial.template=e.editor.getValue();var a=e.partial._id?"post":"put",n="".concat(y.api,"/partials");e.partial._id&&(n="".concat(n,"/").concat(e.partial._id)),e.$http[a](n,e.partial).then(function(t){e.isLoading=!1,e.$toast.open({message:"Successfully saved",position:"is-top",type:"is-success"}),e.partial._id||(e.partial=Lt(),e.$router.push({name:"partial-edit",params:{id:t.body.data.id}}),e.$router.go())},function(t){L.handleUnauthorized(t,e),L.handleInternal(t,e),L.handleLargePayload(t,e),L.isBad(t)&&e.$toast.open({message:"Wrong parameters, cant save template",position:"is-top",type:"is-warning"}),e.isLoading=!1})}}},Et=St,$t=(a("4c85"),Object(u["a"])(Et,Ct,xt,!1,null,null,null)),It=$t.exports;n["default"].use(h["a"]);var Dt=new h["a"]({routes:[{path:"/",alias:"/templates",name:"templates",component:Z},{path:"/templates/edit/:id",name:"template-edit",component:dt,props:!0},{path:"/templates/new",name:"template-new",component:dt},{path:"/partials",name:"partials",component:kt},{path:"/partials/edit/:id",name:"partial-edit",component:It,props:!0},{path:"/partials/new",name:"partial-new",component:It}]});n["default"].use(r["a"]),n["default"].use(c.a),n["default"].use(s.a),n["default"].component("downloadExcel",o["a"]),n["default"].config.productionTip=!1,fetch("/config.json").then(function(t){t.json().then(function(t){y.api=t.BASE_URL,new n["default"]({router:Dt,render:function(t){return t(b)}}).$mount("#app")})})},"56f5":function(t,e,a){},"6e95":function(t,e,a){},"7f10":function(t,e,a){},8262:function(t,e,a){"use strict";a("6e95")},"9c45":function(t,e,a){},c21b:function(t,e,a){},c31e:function(t,e,a){"use strict";a("9c45")},c76a:function(t,e,a){},e434:function(t,e,a){"use strict";a("c76a")}});
//# sourceMappingURL=app.74b5129c.js.map